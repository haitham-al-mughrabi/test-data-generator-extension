<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Debug Image Generators</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug { margin: 10px 0; padding: 10px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Debug Image Generators</h1>
    
    <div id="debug-output"></div>

    <!-- Load scripts step by step -->
    <script src="utils/helpers.js"></script>
    <script src="data/names-data.js"></script>
    <script src="data/saudi-data.js"></script>
    <script src="generators/personal-generators.js"></script>
    
    <script>
        console.log('Step 1: Basic scripts loaded');
        document.getElementById('debug-output').innerHTML += '<div class="debug">Step 1: Basic scripts loaded ✓</div>';
    </script>
    
    <script src="generators/image-url-generators.js"></script>
    
    <script>
        console.log('Step 2: Image generators loaded');
        console.log('window.imageUrlGenerators:', typeof window.imageUrlGenerators);
        console.log('setImageDimensions:', typeof setImageDimensions);
        console.log('getImageDimensions:', typeof getImageDimensions);
        
        let output = document.getElementById('debug-output').innerHTML;
        output += '<div class="debug">Step 2: Image generators script loaded ✓</div>';
        
        if (typeof window.imageUrlGenerators === 'object') {
            output += '<div class="debug success">✅ window.imageUrlGenerators is available</div>';
            const functions = Object.keys(window.imageUrlGenerators);
            output += `<div class="debug">Found ${functions.length} image generator functions:</div>`;
            output += '<pre>' + functions.join('\n') + '</pre>';
        } else {
            output += '<div class="debug error">❌ window.imageUrlGenerators is not available</div>';
        }
        
        if (typeof setImageDimensions === 'function') {
            output += '<div class="debug success">✅ setImageDimensions function available</div>';
        } else {
            output += '<div class="debug error">❌ setImageDimensions function missing</div>';
        }
        
        if (typeof getImageDimensions === 'function') {
            output += '<div class="debug success">✅ getImageDimensions function available</div>';
        } else {
            output += '<div class="debug error">❌ getImageDimensions function missing</div>';
        }
        
        document.getElementById('debug-output').innerHTML = output;
    </script>
    
    <script src="shared.js"></script>
    
    <script>
        console.log('Step 3: Shared.js loaded');
        console.log('window.generators:', typeof window.generators);
        
        let output = document.getElementById('debug-output').innerHTML;
        output += '<div class="debug">Step 3: Shared.js loaded ✓</div>';
        
        if (typeof window.generators === 'object') {
            const totalGenerators = Object.keys(window.generators).length;
            output += `<div class="debug success">✅ window.generators has ${totalGenerators} functions</div>`;
            
            // Check for specific image generators
            const imageGens = ['placeholderImage', 'loremPicsumImage', 'unsplashImage', 'qrCodeUrl'];
            imageGens.forEach(gen => {
                if (typeof window.generators[gen] === 'function') {
                    output += `<div class="debug success">✅ ${gen} registered</div>`;
                } else {
                    output += `<div class="debug error">❌ ${gen} not registered</div>`;
                }
            });
            
        } else {
            output += '<div class="debug error">❌ window.generators is not available</div>';
        }
        
        document.getElementById('debug-output').innerHTML = output;
    </script>
    
    <script>
        // Test actual generation
        setTimeout(() => {
            let output = document.getElementById('debug-output').innerHTML;
            output += '<div class="debug">Step 4: Testing image generation...</div>';
            
            try {
                if (typeof setImageDimensions === 'function') {
                    setImageDimensions(400, 300);
                    output += '<div class="debug success">✅ Set dimensions to 400x300</div>';
                }
                
                if (typeof window.generators.placeholderImage === 'function') {
                    const url = window.generators.placeholderImage();
                    output += `<div class="debug success">✅ Generated placeholder: ${url}</div>`;
                    output += `<div class="debug"><img src="${url}" style="max-width: 200px; border: 1px solid #ddd;"></div>`;
                } else {
                    output += '<div class="debug error">❌ placeholderImage function not available</div>';
                }
                
            } catch (error) {
                output += `<div class="debug error">❌ Error during generation: ${error.message}</div>`;
            }
            
            document.getElementById('debug-output').innerHTML = output;
        }, 100);
    </script>
</body>
</html>